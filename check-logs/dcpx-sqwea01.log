Script started on 2023-06-26 12:37:52+02:00
[0;35m[DEPRECATION WARNING]: "include" is deprecated, use include_tasks/import_tasks instead. See https://docs.ansible.com/ansible-core/2.14/user_guide/playbooks_reuse_includes.html for details.[0m
[0;35m This feature will be removed in version 2.16. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.[0m

PLAY [all] **********************************************************************************************************************************************************************************

TASK [Gathering Facts] **********************************************************************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : include] ***************************************************************************************************************************************************************
[0;35m[DEPRECATION WARNING]: "include" is deprecated, use include_tasks/import_tasks/import_playbook instead. This feature will be removed in version 2.16. Deprecation warnings can be disabled [0m
[0;35mby setting deprecation_warnings=False in ansible.cfg.[0m
[0;36mincluded: /home/gfk.com/ivan.stamov.adm/cis-hardening/roles/cis_security/tasks/CIS-Ubuntu-20.yml for dcpx-sqwea01[0m

TASK [cis_security : include] ***************************************************************************************************************************************************************
[0;36mincluded: /home/gfk.com/ivan.stamov.adm/cis-hardening/roles/cis_security/tasks/type-files/ubuntu-20-type.yml for dcpx-sqwea01[0m

TASK [cis_security : 1.1.1.[1..7] Ensure mounting of unused filesystems is disabled] ********************************************************************************************************
[0;31m--- before: /etc/modprobe.d/cramfs.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/modprobe.d/cramfs.conf (content)[0m
[0;32m[0m[0;36m@@ -0,0 +1 @@[0m
[0;36m[0m[0;32m+install cramfs /bin/true[0m
[0;32m[0m
[0;33mchanged: [dcpx-sqwea01] => (item=cramfs)[0m
[0;31m--- before: /etc/modprobe.d/freevxfs.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/modprobe.d/freevxfs.conf (content)[0m
[0;32m[0m[0;36m@@ -0,0 +1 @@[0m
[0;36m[0m[0;32m+install freevxfs /bin/true[0m
[0;32m[0m
[0;33mchanged: [dcpx-sqwea01] => (item=freevxfs)[0m
[0;31m--- before: /etc/modprobe.d/freevxfs.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/modprobe.d/freevxfs.conf (content)[0m
[0;32m[0m[0;36m@@ -0,0 +1 @@[0m
[0;36m[0m[0;32m+install freevxfs /bin/true[0m
[0;32m[0m
[0;33mchanged: [dcpx-sqwea01] => (item=freevxfs)[0m
[0;31m--- before: /etc/modprobe.d/hfs.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/modprobe.d/hfs.conf (content)[0m
[0;32m[0m[0;36m@@ -0,0 +1 @@[0m
[0;36m[0m[0;32m+install hfs /bin/true[0m
[0;32m[0m
[0;33mchanged: [dcpx-sqwea01] => (item=hfs)[0m
[0;31m--- before: /etc/modprobe.d/hfsplus.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/modprobe.d/hfsplus.conf (content)[0m
[0;32m[0m[0;36m@@ -0,0 +1 @@[0m
[0;36m[0m[0;32m+install hfsplus /bin/true[0m
[0;32m[0m
[0;33mchanged: [dcpx-sqwea01] => (item=hfsplus)[0m
[0;31m--- before: /etc/modprobe.d/udf.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/modprobe.d/udf.conf (content)[0m
[0;32m[0m[0;36m@@ -0,0 +1 @@[0m
[0;36m[0m[0;32m+install udf /bin/true[0m
[0;32m[0m
[0;33mchanged: [dcpx-sqwea01] => (item=udf)[0m
[0;31m--- before: /etc/modprobe.d/jffs2.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/modprobe.d/jffs2.conf (content)[0m
[0;32m[0m[0;36m@@ -0,0 +1 @@[0m
[0;36m[0m[0;32m+install jffs2 /bin/true[0m
[0;32m[0m
[0;33mchanged: [dcpx-sqwea01] => (item=jffs2)[0m

TASK [cis_security : Ensure that unused filesystems are in blacklist] ***********************************************************************************************************************
[0;31mfailed: [dcpx-sqwea01] (item=cramfs) => {"ansible_loop_var": "item", "changed": false, "item": "cramfs", "msg": "Destination /etc/modprobe.d/cramfs.conf does not exist !", "rc": 257}[0m
[0;31mfailed: [dcpx-sqwea01] (item=freevxfs) => {"ansible_loop_var": "item", "changed": false, "item": "freevxfs", "msg": "Destination /etc/modprobe.d/freevxfs.conf does not exist !", "rc": 257}[0m
[0;31mfailed: [dcpx-sqwea01] (item=freevxfs) => {"ansible_loop_var": "item", "changed": false, "item": "freevxfs", "msg": "Destination /etc/modprobe.d/freevxfs.conf does not exist !", "rc": 257}[0m
[0;31mfailed: [dcpx-sqwea01] (item=hfs) => {"ansible_loop_var": "item", "changed": false, "item": "hfs", "msg": "Destination /etc/modprobe.d/hfs.conf does not exist !", "rc": 257}[0m
[0;31mfailed: [dcpx-sqwea01] (item=hfsplus) => {"ansible_loop_var": "item", "changed": false, "item": "hfsplus", "msg": "Destination /etc/modprobe.d/hfsplus.conf does not exist !", "rc": 257}[0m
[0;31mfailed: [dcpx-sqwea01] (item=udf) => {"ansible_loop_var": "item", "changed": false, "item": "udf", "msg": "Destination /etc/modprobe.d/udf.conf does not exist !", "rc": 257}[0m
[0;31mfailed: [dcpx-sqwea01] (item=jffs2) => {"ansible_loop_var": "item", "changed": false, "item": "jffs2", "msg": "Destination /etc/modprobe.d/jffs2.conf does not exist !", "rc": 257}[0m
[0;36m...ignoring[0m

TASK [cis_security : 1.1.1.[1..7] Ensure mounting of cramfs filesystems is disabled | modprobe] *********************************************************************************************
[0;32mok: [dcpx-sqwea01] => (item=cramfs)[0m
[0;32mok: [dcpx-sqwea01] => (item=freevxfs)[0m
[0;32mok: [dcpx-sqwea01] => (item=freevxfs)[0m
[0;32mok: [dcpx-sqwea01] => (item=hfs)[0m
[0;32mok: [dcpx-sqwea01] => (item=hfsplus)[0m
[0;32mok: [dcpx-sqwea01] => (item=udf)[0m
[0;32mok: [dcpx-sqwea01] => (item=jffs2)[0m

TASK [cis_security : 1.1.2 Ensure /tmp is configured] ***************************************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 1.1.2 Ensure /tmp is configured | edit file] ***************************************************************************************************************************
[0;31mfatal: [dcpx-sqwea01]: FAILED! => {"changed": false, "msg": "Destination /etc/systemd/system/tmp.mount does not exist !", "rc": 257}[0m
[0;36m...ignoring[0m

TASK [cis_security : 1.1.2 Ensure /tmp is configured | reload demon] ************************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 1.1.2 Ensure /tmp is configured | enable and start tmp.mount] **********************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : Get file system] *******************************************************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : debug] *****************************************************************************************************************************************************************
[0;32mok: [dcpx-sqwea01] => {[0m
[0;32m    "filesystem.stdout": "ext4"[0m
[0;32m}[0m

TASK [cis_security : Check /tmp config] *****************************************************************************************************************************************************
[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : Remount /tmp] **********************************************************************************************************************************************************
[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 1.1.6 Ensure /dev/shm is configured
 1.1.7 Ensure nodev option set on /dev/shm partition
 1.1.8 Ensure nosuid option set on /dev/shm partition
 1.1.9 Ensure noexec option set on /dev/shm partition] ***
[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 1.1.12 Ensure nodev option set on /var/tmp partitions] *****************************************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : /var/tmp partitions] ***************************************************************************************************************************************************
[0;32mok: [dcpx-sqwea01] => {[0m
[0;32m    "msg": {[0m
[0;32m        "changed": false,[0m
[0;32m        "cmd": "mount | grep \"on /var\" && true || true\n",[0m
[0;32m        "delta": null,[0m
[0;32m        "end": null,[0m
[0;32m        "failed": false,[0m
[0;32m        "msg": "Command would have run if not in check mode",[0m
[0;32m        "rc": 0,[0m
[0;32m        "skipped": true,[0m
[0;32m        "start": null,[0m
[0;32m        "stderr": "",[0m
[0;32m        "stderr_lines": [],[0m
[0;32m        "stdout": "",[0m
[0;32m        "stdout_lines": [][0m
[0;32m    }[0m
[0;32m}[0m

TASK [cis_security : 1.1.18 Ensure nodev option set on /home partition] *********************************************************************************************************************
[0;32mok: [dcpx-sqwea01] => {[0m
[0;32m    "msg": "For new installations, during installation create a custom partition setup and specify a separate partition"[0m
[0;32m}[0m

TASK [cis_security : 1.1.22 Ensure sticky bit is set on all world-writable directories | get info] ******************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 1.1.22 Ensure sticky bit is set on all world-writable directories | fix] ***********************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 1.1.23 Disable Automounting | service disable] *************************************************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 1.1.23 Disable Automounting | package remove] **************************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 1.1.24 Disable USB Storage | modprobe] *********************************************************************************************************************************
[0;31m--- before: /etc/modprobe.d/usb-storage.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/modprobe.d/usb-storage.conf (content)[0m
[0;32m[0m[0;36m@@ -0,0 +1 @@[0m
[0;36m[0m[0;32m+install usb-storage /bin/true[0m
[0;32m[0m
[0;33mchanged: [dcpx-sqwea01] => (item={'From': '(?m)^\\S+\\s+install usb-storage', 'To': 'install usb-storage /bin/true'})[0m
[0;31m--- before: /etc/modprobe.d/usb-storage.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/modprobe.d/usb-storage.conf (content)[0m
[0;32m[0m[0;36m@@ -0,0 +1 @@[0m
[0;36m[0m[0;32m+blacklist usb-storage[0m
[0;32m[0m
[0;33mchanged: [dcpx-sqwea01] => (item={'From': '^(#)?blacklist usb-storage', 'To': 'blacklist usb-storage'})[0m

TASK [cis_security : 1.1.24 Disable USB Storage] ********************************************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 1.3.1 Ensure AIDE is installed] ****************************************************************************************************************************************
The following packages were automatically installed and are no longer required:
  linux-image-4.15.0-204-generic linux-modules-4.15.0-204-generic
  linux-modules-extra-4.15.0-204-generic
Use 'apt autoremove' to remove them.
The following additional packages will be installed:
  liblockfile-bin liblockfile1
Suggested packages:
  figlet
The following NEW packages will be installed:
  aide aide-common liblockfile-bin liblockfile1
0 upgraded, 4 newly installed, 0 to remove and 13 not upgraded.
[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 1.4.1 Ensure permissions on bootloader config are not overridden - step 1 - update chmod 444 to chmod 400 in /usr/sbin/grubmkconfig] ***********************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 1.4.1 Ensure permissions on bootloader config are not overridden - step 2 -  check on password not being set before running chmod command] *****************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 1.4.3 Ensure permissions on bootloader config are configured] **********************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0444",[0m
[0;31m[0m[0;32m+    "mode": "0400",[0m
[0;32m[0m     "path": "/boot/grub/grub.cfg"
 }

[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 1.5.2 Ensure address space layout randomization (ASLR) is enabled] *****************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 1.5.3 Ensure prelink is not installed] *********************************************************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 1.5.3 Ensure prelink is not installed] *********************************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 1.5.4 Ensure core dumps are restricted | sysctl] ***********************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 1.5.4 Ensure core dumps are restricted | limits.conf] ******************************************************************************************************************
[0;31m--- before: /etc/security/limits.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/security/limits.conf (content)[0m
[0;32m[0m[0;36m@@ -53,4 +53,5 @@[0m
[0;36m[0m #ftp             -       chroot          /ftp
 #@student        -       maxlogins       4
 
[0;32m+*                hard    core            0[0m
[0;32m[0m # End of file

[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 1.5.4 Ensure core dumps are restricted | apt] **************************************************************************************************************************
The following packages were automatically installed and are no longer required:
  linux-image-4.15.0-204-generic linux-modules-4.15.0-204-generic
  linux-modules-extra-4.15.0-204-generic
Use 'apt autoremove' to remove them.
The following NEW packages will be installed:
  systemd-coredump
0 upgraded, 1 newly installed, 0 to remove and 13 not upgraded.
[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 1.5.4 Ensure core dumps are restricted | coredump.conf] ****************************************************************************************************************
[0;31m--- before: /etc/systemd/coredump.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/systemd/coredump.conf (content)[0m
[0;32m[0m[0;36m@@ -0,0 +1 @@[0m
[0;36m[0m[0;32m+Storage=none[0m
[0;32m[0m
[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 1.5.4 Ensure core dumps are restricted | coredump.conf] ****************************************************************************************************************
[0;31m--- before: /etc/systemd/coredump.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/systemd/coredump.conf (content)[0m
[0;32m[0m[0;36m@@ -0,0 +1 @@[0m
[0;36m[0m[0;32m+ProcessSizeMax=0[0m
[0;32m[0m
[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 1.5.4 Ensure core dumps are restricted | reload] ***********************************************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 1.6.1.1 Ensure AppArmor is installed] **********************************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 1.6.1.3 Ensure all AppArmor Profiles are in enforce or complain mode
 1.6.1.4 Ensure all AppArmor Profiles are enforcing] ***********************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : Check for custom MOTD] *************************************************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 1.7.1 Ensure message of the day is configured properly
 1.7.4 Ensure permissions on /etc/motd are configured] ***********************************************************
[0;31mfatal: [dcpx-sqwea01]: FAILED! => {"msg": "The conditional check 'motd_status.stat.size < 50' failed. The error was: error while evaluating conditional (motd_status.stat.size < 50): 'dict object' has no attribute 'size'. 'dict object' has no attribute 'size'\n\nThe error appears to be in '/home/gfk.com/ivan.stamov.adm/cis-hardening/roles/cis_security/tasks/type-files/ubuntu-20-type.yml': line 554, column 5, but may\nbe elsewhere in the file depending on the exact syntax problem.\n\nThe offending line appears to be:\n\n#      msg: '{{ motd_status.stat.size }}'\n  - name: \"1.7.1 Ensure message of the day is configured properly\\n\n    ^ here\nThis one looks easy to fix. It seems that there is a value started\nwith a quote, and the YAML parser is expecting to see the line ended\nwith the same kind of quote. For instance:\n\n    when: \"ok\" in result.stdout\n\nCould be written as:\n\n   when: '\"ok\" in result.stdout'\n\nOr equivalently:\n\n   when: \"'ok' in result.stdout\"\n"}[0m
[0;36m...ignoring[0m

TASK [cis_security : 1.7.1 Ensure message of the day is configured properly
 1.7.4 Ensure permissions on /etc/motd are configured  | Show templates used] ************************************
[0;32mok: [dcpx-sqwea01] => {[0m
[0;32m    "msg": "custom file not found, using default"[0m
[0;32m}[0m

TASK [cis_security : Check for custom Issue file] *******************************************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 1.7.2 Ensure local login warning banner is configured properly
 1.7.5 Ensure permissions on /etc/issue are configured] **************************************************
[0;31m--- before: /etc/issue[0m
[0;31m[0m[0;32m+++ after: /root/.ansible/tmp/ansible-local-84243cyyxpcxo/tmpldv0ee0k/issue.j2[0m
[0;32m[0m[0;36m@@ -1,2 +1,5 @@[0m
[0;36m[0m[0;31m-Ubuntu 20.04.5 LTS \n \l[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;32m+-----------------------------------------------------------------------------[0m
[0;32m[0m[0;32m+WARNING: This is a private system.  Do not attempt to login unless you are an[0m
[0;32m[0m[0;32m+authorized user.  Any authorized or unauthorized access and use may be moni-[0m
[0;32m[0m[0;32m+tored and can result in criminal or civil prosecution under applicable law.[0m
[0;32m[0m[0;32m+-----------------------------------------------------------------------------[0m
[0;32m[0m
[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 1.7.2 Ensure local login warning banner is configured properly
 1.7.5 Ensure permissions on /etc/issue are configured  | Show templates used] ***************************
[0;32mok: [dcpx-sqwea01] => {[0m
[0;32m    "msg": "custom file not found, using default"[0m
[0;32m}[0m

TASK [cis_security : 1.7.3 Ensure local remote warning banner is configured properly
 1.7.6 Ensure permissions on /etc/issue.net are configured] *********************************************
[0;31m--- before: /etc/issue.net[0m
[0;31m[0m[0;32m+++ after: /root/.ansible/tmp/ansible-local-84243cyyxpcxo/tmpskg_icsc/issue.net.j2[0m
[0;32m[0m[0;36m@@ -1 +1,5 @@[0m
[0;36m[0m[0;31m-Ubuntu 20.04.5 LTS[0m
[0;31m[0m[0;32m+-----------------------------------------------------------------------------[0m
[0;32m[0m[0;32m+WARNING: This is a private system.  Do not attempt to login unless you are an[0m
[0;32m[0m[0;32m+authorized user.  Any authorized or unauthorized access and use may be moni-[0m
[0;32m[0m[0;32m+tored and can result in criminal or civil prosecution under applicable law.[0m
[0;32m[0m[0;32m+-----------------------------------------------------------------------------[0m
[0;32m[0m
[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 1.7.3 Ensure remote login warning banner is configured properly
 1.7.6 Ensure permissions on /etc/issue.net are configured  | Show templates used] **********************
[0;32mok: [dcpx-sqwea01] => {[0m
[0;32m    "msg": "custom file not found, using default"[0m
[0;32m}[0m

TASK [cis_security : 2.1.1.1 Ensure time synchronization is in use - service install] *******************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 2.1.1.1 Ensure time synchronization is in use - service start] *********************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 2.1.1.2 Remove NTP] ****************************************************************************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 2.1.1.2 Ensure systemd-timesyncd is configured | install systemd-timesyncd] ********************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 2.1.1.2 Ensure systemd-timesyncd is configured | set timezone] *********************************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 2.1.1.2 Ensure systemd-timesyncd is configured | Configure systemd-timesyncd] ******************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 2.1.1.2 Ensure systemd-timesyncd is configured | Start and enable systemd-timesyncd] ***********************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 2.1.1.3 Remove NTP] ****************************************************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 2.1.1.3 Ensure chrony is configured | Install Chrony] ******************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 2.1.1.3 Ensure chrony is configured | Start Chrony service] ************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 2.1.1.3 Ensure chrony is configured | Generate configuration] **********************************************************************************************************
[0;31m--- before: /etc/chrony/chrony.conf[0m
[0;31m[0m[0;32m+++ after: /root/.ansible/tmp/ansible-local-84243cyyxpcxo/tmpgrus_k03/chrony.conf.j2[0m
[0;32m[0m[0;36m@@ -16,6 +16,7 @@[0m
[0;36m[0m # See http://www.pool.ntp.org/join.html for more information.
 server uxtime1.gfk.de iburst
 server uxtime2.gfk.de iburst
[0;32m+[0m
[0;32m[0m # This directive specify the location of the file containing ID/key pairs for
 # NTP authentication.
 keyfile /etc/chrony/chrony.keys

[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 2.1.1.3 Ensure chrony is configured | Restart Chrony service] **********************************************************************************************************
[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 2.1.2 Ensure X Window System is not installed] *************************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 2.1.3 Ensure Avahi Server is not installed] ****************************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 2.1.4 Ensure CUPS is not installed] ************************************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 2.1.5 Ensure DHCP Server is not installed] *****************************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 2.1.6 Ensure LDAP server is not installed] *****************************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 2.2.7 Check for nfs in /etc/fstab] *************************************************************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 2.2.7 Check for nfs shares] ********************************************************************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 2.2.7 Fstab result] ****************************************************************************************************************************************************
[0;32mok: [dcpx-sqwea01] => {[0m
[0;32m    "nfs_mp.stdout": ""[0m
[0;32m}[0m

TASK [cis_security : 2.2.7 Nfs shares found] ************************************************************************************************************************************************
[0;32mok: [dcpx-sqwea01] => {[0m
[0;32m    "nfs_shares.stdout": ""[0m
[0;32m}[0m

TASK [cis_security : 2.1.7 Ensure NFS is not installed] *************************************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 2.1.8 Ensure DNS Server is not installed] ******************************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 2.1.9 Ensure FTP Server is not installed] ******************************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : Check is HTTP server is operational] ***********************************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : Http server status] ****************************************************************************************************************************************************
[0;32mok: [dcpx-sqwea01] => {[0m
[0;32m    "https_service.status.ActiveState": "inactive"[0m
[0;32m}[0m

TASK [cis_security : Ensure HTTP server is not installed] ***********************************************************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 2.1.11 Ensure IMAP and POP3 server are not installed] ******************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 2.1.12 Check is Samba is operational] **********************************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 2.1.12 Check for log files] ********************************************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 2.1.12 Cheking for Samba logs] *****************************************************************************************************************************************
[0;32mok: [dcpx-sqwea01] => {[0m
[0;32m    "smbd_logs.matched": "10"[0m
[0;32m}[0m

TASK [cis_security : 2.1.12 Cheking for Samba service] **************************************************************************************************************************************
[0;32mok: [dcpx-sqwea01] => {[0m
[0;32m    "smbd_service.status.ActiveState": "active"[0m
[0;32m}[0m

TASK [cis_security : 2.1.12 Ensure Samba is not installed] **********************************************************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 2.1.13 Ensure HTTP Proxy Server is not installed] **********************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 2.1.14 Ensure SNMP Server is not installed] ****************************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 2.1.15 Ensure mail transfer agent is configured for local-only mode] ***************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 2.1.15 Ensure mail transfer agent is configured for local-only mode] ***************************************************************************************************
[0;31m--- before: /etc/postfix/main.cf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/postfix/main.cf (content)[0m
[0;32m[0m[0;36m@@ -41,5 +41,5 @@[0m
[0;36m[0m mynetworks = 127.0.0.0/8 [::ffff:127.0.0.0]/104 [::1]/128
 mailbox_size_limit = 0
 recipient_delimiter = +
[0;31m-inet_interfaces = loopback-only[0m
[0;31m[0m[0;32m+inet_interfaces = 127.0.0.1[0m
[0;32m[0m inet_protocols = ipv4

[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 2.1.15 Restart Mail transfer agent] ************************************************************************************************************************************
[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 2.1.16 Ensure rsync service is not installed] **************************************************************************************************************************
The following packages were automatically installed and are no longer required:
  linux-image-4.15.0-204-generic linux-modules-4.15.0-204-generic
  linux-modules-extra-4.15.0-204-generic
Use 'apt autoremove' to remove them.
The following packages will be REMOVED:
  rsync* ubuntu-standard*
0 upgraded, 0 newly installed, 2 to remove and 13 not upgraded.
[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 2.1.17 Ensure NIS Server is not installed] *****************************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 2.2.1 Ensure NIS Client is not installed] ******************************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 2.2.2 Ensure rsh client is not installed] ******************************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 2.2.3 Ensure talk client is not installed] *****************************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 2.2.4 Ensure telnet client is not installed] ***************************************************************************************************************************
The following packages were automatically installed and are no longer required:
  linux-image-4.15.0-204-generic linux-modules-4.15.0-204-generic
  linux-modules-extra-4.15.0-204-generic
Use 'apt autoremove' to remove them.
The following packages will be REMOVED:
  telnet*
0 upgraded, 0 newly installed, 1 to remove and 13 not upgraded.
[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 2.2.5 Ensure LDAP client is not installed] *****************************************************************************************************************************
The following packages were automatically installed and are no longer required:
  linux-image-4.15.0-204-generic linux-modules-4.15.0-204-generic
  linux-modules-extra-4.15.0-204-generic
Use 'apt autoremove' to remove them.
The following packages will be REMOVED:
  ldap-utils*
0 upgraded, 0 newly installed, 1 to remove and 13 not upgraded.
[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : verify no wireless interfaces are active on the system] ****************************************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 3.1.2 Ensure wireless interfaces are disabled] *************************************************************************************************************************
[0;31mfatal: [dcpx-sqwea01]: FAILED! => {"msg": "The conditional check 'wifiStatus.stdout_lines ==  \"Wireless is not enabled\"' failed. The error was: error while evaluating conditional (wifiStatus.stdout_lines ==  \"Wireless is not enabled\"): 'dict object' has no attribute 'stdout_lines'. 'dict object' has no attribute 'stdout_lines'\n\nThe error appears to be in '/home/gfk.com/ivan.stamov.adm/cis-hardening/roles/cis_security/tasks/type-files/ubuntu-20-type.yml': line 1227, column 7, but may\nbe elsewhere in the file depending on the exact syntax problem.\n\nThe offending line appears to be:\n\n      changed_when: false\n    - name: 3.1.2 Ensure wireless interfaces are disabled\n      ^ here\n"}[0m
[0;36m...ignoring[0m

TASK [cis_security : 3.2.1 Ensure packet redirect sending is disabled | set] ****************************************************************************************************************
[0;32mok: [dcpx-sqwea01] => (item={'name': 'net.ipv4.conf.all.send_redirects', 'value': 0})[0m
[0;32mok: [dcpx-sqwea01] => (item={'name': 'net.ipv4.conf.default.send_redirects', 'value': 0})[0m

TASK [cis_security : 3.2.1 Ensure packet redirect sending is disabled | load] ***************************************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : Check for runing docker] ***********************************************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : Docker service status] *************************************************************************************************************************************************
[0;32mok: [dcpx-sqwea01] => {[0m
[0;32m    "docker_service.status.ActiveState": "inactive"[0m
[0;32m}[0m

TASK [cis_security : 3.2.2 Ensure IP forwarding is disabled | ipv4"] ************************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 3.2.2 Ensure IP forwarding is disabled | ipv6"] ************************************************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 3.2.2 Ensure IP forwarding is disabled | IPV4 load"] *******************************************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 3.2.2 Ensure IP forwarding is disabled | IPV6 load"] *******************************************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 3.3.1 Ensure source routed packets are not accepted | ipv4"] ***********************************************************************************************************
[0;32mok: [dcpx-sqwea01] => (item={'name': 'net.ipv4.conf.all.accept_source_route', 'value': 0})[0m
[0;32mok: [dcpx-sqwea01] => (item={'name': 'net.ipv4.conf.default.accept_source_route', 'value': 0})[0m

TASK [cis_security : 3.3.1 Ensure source routed packets are not accepted | ipv4 load"] ******************************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 3.3.1 Ensure source routed packets are not accepted | ipv6"] ***********************************************************************************************************
[0;36mskipping: [dcpx-sqwea01] => (item={'name': 'net.ipv6.conf.all.accept_source_route', 'value': 0}) [0m
[0;36mskipping: [dcpx-sqwea01] => (item={'name': 'net.ipv6.conf.default.accept_source_route', 'value': 0}) [0m
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 3.3.1 Ensure source routed packets are not accepted | ipv6 load"] ******************************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 3.3.2 Ensure ICMP redirects are not accepted | ipv4"] ******************************************************************************************************************
[0;32mok: [dcpx-sqwea01] => (item={'name': 'net.ipv4.conf.all.accept_redirects', 'value': 0})[0m
[0;32mok: [dcpx-sqwea01] => (item={'name': 'net.ipv4.conf.default.accept_redirects', 'value': 0})[0m

TASK [cis_security : shell] *****************************************************************************************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 3.3.2 Ensure ICMP redirects are not accepted | ipv6"] ******************************************************************************************************************
[0;36mskipping: [dcpx-sqwea01] => (item={'name': 'net.ipv6.conf.all.accept_redirects', 'value': 0}) [0m
[0;36mskipping: [dcpx-sqwea01] => (item={'name': 'net.ipv6.conf.default.accept_redirects', 'value': 0}) [0m
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : shell] *****************************************************************************************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 3.3.3 Ensure secure ICMP redirects are not accepted | save] ************************************************************************************************************
[0;32mok: [dcpx-sqwea01] => (item={'name': 'net.ipv4.conf.all.secure_redirects', 'value': 0})[0m
[0;32mok: [dcpx-sqwea01] => (item={'name': 'net.ipv4.conf.default.secure_redirects', 'value': 0})[0m

TASK [cis_security : 3.3.3 Ensure secure ICMP redirects are not accepted | load] ************************************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 3.3.4 Ensure suspicious packets are logged | save] *********************************************************************************************************************
[0;32mok: [dcpx-sqwea01] => (item={'name': 'net.ipv4.conf.all.log_martians', 'value': 1})[0m
[0;32mok: [dcpx-sqwea01] => (item={'name': 'net.ipv4.conf.default.log_martians', 'value': 1})[0m

TASK [cis_security : 3.3.4 Ensure suspicious packets are logged | load] *********************************************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 3.3.5 Ensure broadcast ICMP requests are ignored | save] ***************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 3.3.5 Ensure broadcast ICMP requests are ignored | load] ***************************************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 3.3.6 Ensure bogus ICMP responses are ignored | save] ******************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 3.3.6 Ensure bogus ICMP responses are ignored | load] ******************************************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 3.3.7 Ensure Reverse Path Filtering is enabled | save] *****************************************************************************************************************
[0;32mok: [dcpx-sqwea01] => (item={'name': 'net.ipv4.conf.all.rp_filter', 'value': 1})[0m
[0;32mok: [dcpx-sqwea01] => (item={'name': 'net.ipv4.conf.default.rp_filter', 'value': 1})[0m

TASK [cis_security : 3.3.7 Ensure Reverse Path Filtering is enabled | load] *****************************************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 3.3.8 Ensure TCP SYN Cookies is enabled | save] ************************************************************************************************************************
[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 3.3.8 Ensure TCP SYN Cookies is enabled | load] ************************************************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 3.3.9 Ensure IPv6 router advertisements are not accepted | save] *******************************************************************************************************
[0;36mskipping: [dcpx-sqwea01] => (item={'name': 'net.ipv6.conf.all.accept_ra', 'value': 0}) [0m
[0;36mskipping: [dcpx-sqwea01] => (item={'name': 'net.ipv6.conf.default.accept_ra', 'value': 0}) [0m
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 3.3.9 Ensure IPv6 router advertisements are not accepted | load] *******************************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 3.5.1.1 Ensure ufw is installed |Â ufw] *********************************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 3.5.1.2 Ensure iptables-persistent is not installed] *******************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 3.5.3.1.2 Ensure ufw is uninstalled or disabled with nftables] *********************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 4.2.1.1 Ensure rsyslog is installed] ***********************************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 4.2.1.2 Ensure rsyslog Service is enabled] *****************************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 4.2.1.4 Ensure rsyslog default file permissions configured] ************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 4.2.1.5 Ensure rsyslog default file permissions configured] ************************************************************************************************************
[0;31m--- before: /etc/rsyslog.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/rsyslog.conf (content)[0m
[0;32m[0m[0;36m@@ -57,3 +57,4 @@[0m
[0;36m[0m # Include all config files in /etc/rsyslog.d/
 #
 $IncludeConfig /etc/rsyslog.d/*.conf
[0;32m+ *.* action(type="omfwd" target="192.168.2.100" port="514" protocol="tcp"action.resumeRetryCount="100"queue.type="LinkedList" queue.size="1000")[0m
[0;32m[0m
[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 4.2.2.1 Ensure journald is configured to send logs to rsyslog] *********************************************************************************************************
[0;31m--- before: /etc/systemd/journald.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/systemd/journald.conf (content)[0m
[0;32m[0m[0;36m@@ -29,7 +29,7 @@[0m
[0;36m[0m #RuntimeMaxFiles=100
 #MaxRetentionSec=
 #MaxFileSec=1month
[0;31m-#ForwardToSyslog=yes[0m
[0;31m[0m[0;32m+ForwardToSyslog=yes[0m
[0;32m[0m #ForwardToKMsg=no
 #ForwardToConsole=no
 #ForwardToWall=yes

[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 4.2.2.2 Ensure journald is configured to compress large log files] *****************************************************************************************************
[0;31m--- before: /etc/systemd/journald.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/systemd/journald.conf (content)[0m
[0;32m[0m[0;36m@@ -13,7 +13,7 @@[0m
[0;36m[0m 
 [Journal]
 #Storage=auto
[0;31m-#Compress=yes[0m
[0;31m[0m[0;32m+Compress=yes[0m
[0;32m[0m #Seal=yes
 #SplitMode=uid
 #SyncIntervalSec=5m

[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 4.2.2.3 Ensure journald is configured to write logfiles to persistent disk] ********************************************************************************************
[0;31m--- before: /etc/systemd/journald.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/systemd/journald.conf (content)[0m
[0;32m[0m[0;36m@@ -12,7 +12,7 @@[0m
[0;36m[0m # See journald.conf(5) for details.
 
 [Journal]
[0;31m-#Storage=auto[0m
[0;31m[0m[0;32m+Storage=persistent[0m
[0;32m[0m #Compress=yes
 #Seal=yes
 #SplitMode=uid

[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 5.1.1 Ensure cron daemon is enabled and running] ***********************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 5.1.2 Ensure permissions on /etc/crontab are configured] ***************************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0644",[0m
[0;31m[0m[0;32m+    "mode": "0600",[0m
[0;32m[0m     "path": "/etc/crontab"
 }

[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 5.1.3 Ensure permissions on /etc/cron.hourly are configured] ***********************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0755",[0m
[0;31m[0m[0;32m+    "mode": "0600",[0m
[0;32m[0m     "path": "/etc/cron.hourly"
 }

[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 5.1.4 Ensure permissions on /etc/cron.daily are configured] ************************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0755",[0m
[0;31m[0m[0;32m+    "mode": "0600",[0m
[0;32m[0m     "path": "/etc/cron.daily"
 }

[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 5.1.5 Ensure permissions on /etc/cron.weekly are configured] ***********************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0755",[0m
[0;31m[0m[0;32m+    "mode": "0600",[0m
[0;32m[0m     "path": "/etc/cron.weekly"
 }

[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 5.1.6 Ensure permissions on /etc/cron.monthly are configured] **********************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0755",[0m
[0;31m[0m[0;32m+    "mode": "0600",[0m
[0;32m[0m     "path": "/etc/cron.monthly"
 }

[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 5.1.7 Ensure permissions on /etc/cron.d are configured] ****************************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0755",[0m
[0;31m[0m[0;32m+    "mode": "0600",[0m
[0;32m[0m     "path": "/etc/cron.d"
 }

[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 5.1.8 Ensure cron is restricted to authorized users | /etc/cron.deny] **************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : stat] ******************************************************************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 5.1.8 Ensure cron is restricted to authorized users | /etc/cron.allow] *************************************************************************************************
[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 5.1.9 Ensure at is restricted to authorized users | /etc/at.deny] ******************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : stat] ******************************************************************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 5.1.9 Ensure at is restricted to authorized users | /etc/at.allow] *****************************************************************************************************
[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 5.2.1 Ensure sudo is installed] ****************************************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 5.2.2 Ensure sudo commands use pty] ************************************************************************************************************************************
[0;31m--- before: /etc/sudoers (content)[0m
[0;31m[0m[0;32m+++ after: /etc/sudoers (content)[0m
[0;32m[0m[0;36m@@ -28,3 +28,4 @@[0m
[0;36m[0m # See sudoers(5) for more information on "#include" directives:
 
 #includedir /etc/sudoers.d
[0;32m+Defaults use_pty[0m
[0;32m[0m
[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 5.2.3 Ensure sudo log file exists] *************************************************************************************************************************************
[0;31m--- before: /etc/sudoers (content)[0m
[0;31m[0m[0;32m+++ after: /etc/sudoers (content)[0m
[0;32m[0m[0;36m@@ -28,3 +28,4 @@[0m
[0;36m[0m # See sudoers(5) for more information on "#include" directives:
 
 #includedir /etc/sudoers.d
[0;32m+Defaults    logfile=/var/log/sudo.log[0m
[0;32m[0m
[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 5.3.1 Ensure permissions on /etc/ssh/sshd_config are configured] *******************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0644",[0m
[0;31m[0m[0;32m+    "mode": "0600",[0m
[0;32m[0m     "path": "/etc/ssh/sshd_config"
 }

[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 5.3.2 Ensure permissions on SSH private host key files are configured | find keys] *************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 5.3.2 Ensure permissions on SSH private host key files are configured | fix permissions] *******************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 5.3.3 Ensure permissions on SSH public host key files are configured | find keys] **************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 5.3.3 Ensure permissions on SSH public host key files are configured | fix permissions] ********************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 5.3.4 Ensure SSH access is limited | allow groups] *********************************************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 5.3.4 Ensure SSH access is limited | denyusers] ************************************************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 5.3.4 Ensure SSH access is limited | denygroups] ***********************************************************************************************************************
[0;31m--- before: /etc/ssh/sshd_config (content)[0m
[0;31m[0m[0;32m+++ after: /etc/ssh/sshd_config (content)[0m
[0;32m[0m[0;36m@@ -128,3 +128,4 @@[0m
[0;36m[0m Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr
 #AuthenticationMethods publickey
 PasswordAuthentication yes
[0;32m+DenyGroups games[0m
[0;32m[0m
[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 5.3.5 Ensure SSH LogLevel is appropriate] ******************************************************************************************************************************
[0;31m--- before: /etc/ssh/sshd_config (content)[0m
[0;31m[0m[0;32m+++ after: /etc/ssh/sshd_config (content)[0m
[0;32m[0m[0;36m@@ -128,3 +128,4 @@[0m
[0;36m[0m Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr
 #AuthenticationMethods publickey
 PasswordAuthentication yes
[0;32m+LogLevel VERBOSE[0m
[0;32m[0m
[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 5.3.7 Ensure SSH MaxAuthTries is set to 4 or less] *********************************************************************************************************************
[0;31m--- before: /etc/ssh/sshd_config (content)[0m
[0;31m[0m[0;32m+++ after: /etc/ssh/sshd_config (content)[0m
[0;32m[0m[0;36m@@ -32,7 +32,7 @@[0m
[0;36m[0m #PermitRootLogin prohibit-password
 PermitRootLogin yes
 #StrictModes yes
[0;31m-#MaxAuthTries 6[0m
[0;31m[0m[0;32m+MaxAuthTries 2[0m
[0;32m[0m #MaxSessions 10
 
 #PubkeyAuthentication yes

[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 5.3.8 Ensure SSH IgnoreRhosts is enabled] ******************************************************************************************************************************
[0;31m--- before: /etc/ssh/sshd_config (content)[0m
[0;31m[0m[0;32m+++ after: /etc/ssh/sshd_config (content)[0m
[0;32m[0m[0;36m@@ -128,3 +128,4 @@[0m
[0;36m[0m Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr
 #AuthenticationMethods publickey
 PasswordAuthentication yes
[0;32m+IgnoreRhosts yes[0m
[0;32m[0m
[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 5.3.9 Ensure SSH HostbasedAuthentication is disabled] ******************************************************************************************************************
[0;31m--- before: /etc/ssh/sshd_config (content)[0m
[0;31m[0m[0;32m+++ after: /etc/ssh/sshd_config (content)[0m
[0;32m[0m[0;36m@@ -128,3 +128,4 @@[0m
[0;36m[0m Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr
 #AuthenticationMethods publickey
 PasswordAuthentication yes
[0;32m+HostbasedAuthentication no[0m
[0;32m[0m
[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 5.3.11 Ensure SSH PermitEmptyPasswords is disabled] ********************************************************************************************************************
[0;31m--- before: /etc/ssh/sshd_config (content)[0m
[0;31m[0m[0;32m+++ after: /etc/ssh/sshd_config (content)[0m
[0;32m[0m[0;36m@@ -128,3 +128,4 @@[0m
[0;36m[0m Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr
 #AuthenticationMethods publickey
 PasswordAuthentication yes
[0;32m+PermitEmptyPasswords no[0m
[0;32m[0m
[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 5.3.12 Ensure SSH PermitUserEnvironment is disabled] *******************************************************************************************************************
[0;31m--- before: /etc/ssh/sshd_config (content)[0m
[0;31m[0m[0;32m+++ after: /etc/ssh/sshd_config (content)[0m
[0;32m[0m[0;36m@@ -128,3 +128,4 @@[0m
[0;36m[0m Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr
 #AuthenticationMethods publickey
 PasswordAuthentication yes
[0;32m+PermitUserEnvironment no[0m
[0;32m[0m
[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 5.3.13 Ensure only strong Ciphers are used] ****************************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 5.3.14 Ensure only strong MAC algorithms are used] *********************************************************************************************************************
[0;31m--- before: /etc/ssh/sshd_config (content)[0m
[0;31m[0m[0;32m+++ after: /etc/ssh/sshd_config (content)[0m
[0;32m[0m[0;36m@@ -124,7 +124,7 @@[0m
[0;36m[0m 
 # https://infosec.mozilla.org/guidelines/openssh
 KexAlgorithms curve25519-sha256@libssh.org,ecdh-sha2-nistp521,ecdh-sha2-nistp384,ecdh-sha2-nistp256,diffie-hellman-group-exchange-sha256
[0;31m-MACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-512,hmac-sha2-256,umac-128@openssh.com[0m
[0;31m[0m[0;32m+MACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512,hmac-sha2-256[0m
[0;32m[0m Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr
 #AuthenticationMethods publickey
 PasswordAuthentication yes

[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 5.3.15 Ensure only strong Key Exchange algorithms are used] ************************************************************************************************************
[0;31m--- before: /etc/ssh/sshd_config (content)[0m
[0;31m[0m[0;32m+++ after: /etc/ssh/sshd_config (content)[0m
[0;32m[0m[0;36m@@ -123,7 +123,7 @@[0m
[0;36m[0m #	ForceCommand cvs server
 
 # https://infosec.mozilla.org/guidelines/openssh
[0;31m-KexAlgorithms curve25519-sha256@libssh.org,ecdh-sha2-nistp521,ecdh-sha2-nistp384,ecdh-sha2-nistp256,diffie-hellman-group-exchange-sha256[0m
[0;31m[0m[0;32m+KexAlgorithms curve25519-sha256@libssh.org,diffie-hellman-group-exchange-sha256[0m
[0;32m[0m MACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-512,hmac-sha2-256,umac-128@openssh.com
 Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr
 #AuthenticationMethods publickey

[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 5.3.16 Ensure SSH Idle Timeout Interval is configured | clientalive] ***************************************************************************************************
[0;31m--- before: /etc/ssh/sshd_config (content)[0m
[0;31m[0m[0;32m+++ after: /etc/ssh/sshd_config (content)[0m
[0;32m[0m[0;36m@@ -128,3 +128,4 @@[0m
[0;36m[0m Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr
 #AuthenticationMethods publickey
 PasswordAuthentication yes
[0;32m+ClientAliveInterval 300[0m
[0;32m[0m
[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 5.3.16 Ensure SSH Idle Timeout Interval is configured | MaxAlive] ******************************************************************************************************
[0;31m--- before: /etc/ssh/sshd_config (content)[0m
[0;31m[0m[0;32m+++ after: /etc/ssh/sshd_config (content)[0m
[0;32m[0m[0;36m@@ -128,3 +128,4 @@[0m
[0;36m[0m Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr
 #AuthenticationMethods publickey
 PasswordAuthentication yes
[0;32m+ClientAliveCountMax 3[0m
[0;32m[0m
[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 5.3.17 Ensure SSH LoginGraceTime is set to one minute or less] *********************************************************************************************************
[0;31m--- before: /etc/ssh/sshd_config (content)[0m
[0;31m[0m[0;32m+++ after: /etc/ssh/sshd_config (content)[0m
[0;32m[0m[0;36m@@ -128,3 +128,4 @@[0m
[0;36m[0m Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr
 #AuthenticationMethods publickey
 PasswordAuthentication yes
[0;32m+LoginGraceTime 30[0m
[0;32m[0m
[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 5.3.18 Ensure SSH warning banner is configured] ************************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 5.3.19 Ensure SSH PAM is enabled] **************************************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 5.3.21 Ensure SSH MaxStartups is configured to 10:30:60] ***************************************************************************************************************
[0;31m--- before: /etc/ssh/sshd_config (content)[0m
[0;31m[0m[0;32m+++ after: /etc/ssh/sshd_config (content)[0m
[0;32m[0m[0;36m@@ -128,3 +128,4 @@[0m
[0;36m[0m Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr
 #AuthenticationMethods publickey
 PasswordAuthentication yes
[0;32m+MaxStartups 10:30:60[0m
[0;32m[0m
[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 5.3.22 Ensure SSH MaxSessions is limited to 4] *************************************************************************************************************************
[0;31m--- before: /etc/ssh/sshd_config (content)[0m
[0;31m[0m[0;32m+++ after: /etc/ssh/sshd_config (content)[0m
[0;32m[0m[0;36m@@ -128,3 +128,4 @@[0m
[0;36m[0m Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr
 #AuthenticationMethods publickey
 PasswordAuthentication yes
[0;32m+MaxSessions 4[0m
[0;32m[0m
[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : restart_sshd] **********************************************************************************************************************************************************
[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 5.4 Ensure access to the su command is restricted  | create pam-d-su] **************************************************************************************************
[0;31m--- before: /etc/pam.d/common-password[0m
[0;31m[0m[0;32m+++ after: /root/.ansible/tmp/ansible-local-84243cyyxpcxo/tmpyoa_x3yp/common-pass.j2[0m
[0;32m[0m[0;36m@@ -22,16 +22,16 @@[0m
[0;36m[0m # pam-auth-update(8) for details.
 
 # here are the per-package modules (the "Primary" block)
[0;31m-password	requisite			pam_pwquality.so retry=3[0m
[0;31m[0m[0;31m-password	requisite     pam_passwdqc.so min=disabled,disabled,16,12,8[0m
[0;31m[0m[0;31m-password	[success=3 default=ignore]	pam_unix.so obscure use_authtok try_first_pass sha512[0m
[0;31m[0m[0;31m-password	[success=2 default=ignore]	pam_winbind.so try_authtok try_first_pass[0m
[0;31m[0m[0;31m-password	sufficient			pam_sss.so use_authtok[0m
[0;31m[0m[0;32m+#password       requisite                       pam_pwquality.so retry=3[0m
[0;32m[0m[0;32m+password [success=1 default=ignore]     pam_unix.so obscure sha512[0m
[0;32m[0m # here's the fallback if no module succeeds
[0;31m-password	requisite			pam_deny.so[0m
[0;31m[0m[0;32m+password        requisite                       pam_deny.so[0m
[0;32m[0m # prime the stack with a positive return value if there isn't one already;
 # this avoids us returning an error just because nothing sets a success code
 # since the modules above will each just jump around
[0;31m-password	required			pam_permit.so[0m
[0;31m[0m[0;32m+password        required                        pam_permit.so[0m
[0;32m[0m # and here are more per-package modules (the "Additional" block)
 # end of pam-auth-update config
[0;32m+#password        required                        pam_pwhistory.so remember=5[0m
[0;32m[0m[0;32m+#password requisite pam_pwquality.so try_first_pass retry=3[0m
[0;32m[0m[0;32m+[0m
[0;32m[0m
[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 5.5.1.1 Ensure minimum days between password changes is configured | PASS_MIN_DAYS] ************************************************************************************
[0;31m--- before: /etc/login.defs (content)[0m
[0;31m[0m[0;32m+++ after: /etc/login.defs (content)[0m
[0;32m[0m[0;36m@@ -101,7 +101,7 @@[0m
[0;36m[0m PASS_MAX_DAYS 99999
 
 # Minimum number of days allowed between password changes.
[0;31m-PASS_MIN_DAYS 0[0m
[0;31m[0m[0;32m+PASS_MIN_DAYS   0[0m
[0;32m[0m 
 # Number of days warning given before a password expires.
 PASS_WARN_AGE	7

[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 5.5.1.1 Ensure minimum days between password changes is configured  | chage --mindays] *********************************************************************************
[0;36mskipping: [dcpx-sqwea01] => (item=root) [0m
[0;36mskipping: [dcpx-sqwea01] => (item=sshaccess) [0m
[0;36mskipping: [dcpx-sqwea01] => (item=pam_rpcdisc) [0m
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 5.5.1.3 Ensure password expiration warning days is 7 or more | PASS_WARN_AGE] ******************************************************************************************
[0;31m--- before: /etc/login.defs (content)[0m
[0;31m[0m[0;32m+++ after: /etc/login.defs (content)[0m
[0;32m[0m[0;36m@@ -104,7 +104,7 @@[0m
[0;36m[0m PASS_MIN_DAYS 0
 
 # Number of days warning given before a password expires.
[0;31m-PASS_WARN_AGE	7[0m
[0;31m[0m[0;32m+PASS_WARN_AGE  7[0m
[0;32m[0m 
 # Min/max values for automatic uid selection in useradd
 UID_MIN			 1000

[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 5.5.1.3 Ensure password expiration warning days is 7 or more  | chage --warndays] **************************************************************************************
[0;36mskipping: [dcpx-sqwea01] => (item=root) [0m
[0;36mskipping: [dcpx-sqwea01] => (item=sshaccess) [0m
[0;36mskipping: [dcpx-sqwea01] => (item=pam_rpcdisc) [0m
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 5.5.1.5 Ensure all users last password change date is in the past | get list] ******************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 5.5.1.5 Ensure all users last password change date is in the past | save list] *****************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after: /root/.ansible/tmp/ansible-local-84243cyyxpcxo/tmp9bfaddb6[0m
[0;32m[0m[0;36m@@ -0,0 +1 @@[0m
[0;36m[0m[0;32m+[][0m
[0;32m\ No newline at end of file[0m
[0;32m[0m
[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 5.5.2 Ensure system accounts are secured | set all system accounts to a non login shell] *******************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 5.5.3 Ensure default group for the root account is GID 0] **************************************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 5.5.4 Ensure default user umask is 027 or more restrictive - /etc/profile] *********************************************************************************************
[0;31m--- before: /etc/profile (content)[0m
[0;31m[0m[0;32m+++ after: /etc/profile (content)[0m
[0;32m[0m[0;36m@@ -25,3 +25,4 @@[0m
[0;36m[0m   done
   unset i
 fi
[0;32m+umask 027[0m
[0;32m[0m
[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 5.5.4 Ensure default user umask is 027 or more restrictive - Fix for /etc/apt/apt.conf.d/50command-not-found] **********************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 5.5.5 Ensure default user shell timeout is 900 seconds or less | /etc/profile] *****************************************************************************************
[0;31m--- before: /etc/profile (content)[0m
[0;31m[0m[0;32m+++ after: /etc/profile (content)[0m
[0;32m[0m[0;36m@@ -25,3 +25,4 @@[0m
[0;36m[0m   done
   unset i
 fi
[0;32m+readonly TMOUT=900 ; export TMOUT[0m
[0;32m[0m
[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 5.7 Ensure access to the su command is restricted  | create pam-d-su] **************************************************************************************************
[0;31m--- before: /etc/pam.d/su[0m
[0;31m[0m[0;32m+++ after: /root/.ansible/tmp/ansible-local-84243cyyxpcxo/tmp9v4vrk5s/pam-d-su.j2[0m
[0;32m[0m[0;36m@@ -12,7 +12,7 @@[0m
[0;36m[0m # denying "root" user, unless she's a member of "foo" or explicitly
 # permitted earlier by e.g. "sufficient pam_rootok.so").
 # (Replaces the `SU_WHEEL_ONLY' option from login.defs)
[0;31m-# auth       required   pam_wheel.so[0m
[0;31m[0m[0;32m+auth           required        pam_wheel.so use_uid[0m
[0;32m[0m 
 # Uncomment this if you want wheel members to be able to
 # su without a password.
[0;36m@@ -20,7 +20,7 @@[0m
[0;36m[0m 
 # Uncomment this if you want members of a specific group to not
 # be allowed to use su at all.
[0;31m-# auth       required   pam_wheel.so deny group=nosu[0m
[0;31m[0m[0;32m+#auth           required        pam_wheel.so use_uid deny group=nosu[0m
[0;32m[0m 
 # Uncomment and edit /etc/security/time.conf if you need to set
 # time restrainst on su usage.
[0;36m@@ -31,7 +31,7 @@[0m
[0;36m[0m # This module parses environment configuration file(s)
 # and also allows you to use an extended config
 # file /etc/security/pam_env.conf.
[0;31m-# [0m
[0;31m[0m[0;32m+#[0m
[0;32m[0m # parsing /etc/environment needs "readenv=1"
 session       required   pam_env.so readenv=1
 # locale variables are also kept into /etc/default/locale in etch
[0;36m@@ -40,7 +40,7 @@[0m
[0;36m[0m 
 # Defines the MAIL environment variable
 # However, userdel also needs MAIL_DIR and MAIL_FILE variables
[0;31m-# in /etc/login.defs to make sure that removing a user [0m
[0;31m[0m[0;32m+# in /etc/login.defs to make sure that removing a user[0m
[0;32m[0m # also removes the user's mail spool file.
 # See comments in /etc/login.defs
 #
[0;36m@@ -58,4 +58,3 @@[0m
[0;36m[0m @include common-account
 @include common-session
 
[0;31m-[0m
[0;31m[0m
[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : Creates Hardening directory] *******************************************************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
     "path": "/root/hardening",
[0;31m-    "state": "absent"[0m
[0;31m[0m[0;32m+    "state": "directory"[0m
[0;32m[0m }

[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 6.1.2 Ensure permissions on /etc/passwd are configured] ****************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 6.1.3 Ensure permissions on /etc/passwd- are configured] ***************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 6.1.4 Ensure permissions on /etc/group are configured] *****************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 6.1.5 Ensure permissions on /etc/group- are configured] ****************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 6.1.6 Ensure permissions on /etc/shadow are configured, with group 'shadow'] *******************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 6.1.7 Ensure permissions on /etc/shadow- are configured] ***************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 6.1.8 Ensure permissions on /etc/gshadow are configured] ***************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 6.1.9 Ensure permissions on /etc/gshadow- are configured] **************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 6.1.10 Ensure no world writable files exist | find files] **************************************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 6.1.10 Ensure no world writable files exist | save output] *************************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after: /root/.ansible/tmp/ansible-local-84243cyyxpcxo/tmphbmoy0e0[0m
[0;32m[0m[0;36m@@ -0,0 +1 @@[0m
[0;36m[0m[0;32m+[][0m
[0;32m\ No newline at end of file[0m
[0;32m[0m
[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 6.2.1 Ensure accounts in /etc/passwd use shadowed passwords] ***********************************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 6.2.2  Ensure password fields are not empty | list] ********************************************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 6.2.2 Ensure password fields are not empty | Save output] **************************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after: /root/.ansible/tmp/ansible-local-84243cyyxpcxo/tmplon6qs8y[0m
[0;32m[0m[0;36m@@ -0,0 +1 @@[0m
[0;36m[0m[0;32m+[][0m
[0;32m\ No newline at end of file[0m
[0;32m[0m
[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 6.2.2 Ensure password fields are not empty | Lock account] *************************************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 6.2.3 Ensure all groups in /etc/passwd exist in /etc/group | list] *****************************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 6.2.3 Ensure all groups in /etc/passwd exist in /etc/group | save output] **********************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 6.2.4 Ensure all users' home directories exist | list] *****************************************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 6.2.4 Ensure all users' home directories exist | save] *****************************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after: /root/.ansible/tmp/ansible-local-84243cyyxpcxo/tmpgtm233f7[0m
[0;32m[0m[0;36m@@ -0,0 +1 @@[0m
[0;36m[0m[0;32m+[][0m
[0;32m\ No newline at end of file[0m
[0;32m[0m
[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 6.2.4 Ensure all users' home directories exist | fix] ******************************************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 6.2.5 Ensure users own their home directories | list] ******************************************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 6.2.5 Ensure users own their home directories | Var] *******************************************************************************************************************
[0;31mfatal: [dcpx-sqwea01]: FAILED! => {"msg": "The task includes an option with an undefined variable. The error was: 'dict object' has no attribute 'stdout_lines'. 'dict object' has no attribute 'stdout_lines'\n\nThe error appears to be in '/home/gfk.com/ivan.stamov.adm/cis-hardening/roles/cis_security/tasks/type-files/ubuntu-20-type.yml': line 2928, column 7, but may\nbe elsewhere in the file depending on the exact syntax problem.\n\nThe offending line appears to be:\n\n      changed_when: false\n    - name: 6.2.5 Ensure users own their home directories | Var\n      ^ here\n"}[0m
[0;36m...ignoring[0m

TASK [cis_security : 6.2.5 Ensure users own their home directories | save output] ***********************************************************************************************************
[0;31mfatal: [dcpx-sqwea01]: FAILED! => {"msg": "The task includes an option with an undefined variable. The error was: 'output_6_2_5_list' is undefined. 'output_6_2_5_list' is undefined\n\nThe error appears to be in '/home/gfk.com/ivan.stamov.adm/cis-hardening/roles/cis_security/tasks/type-files/ubuntu-20-type.yml': line 2931, column 7, but may\nbe elsewhere in the file depending on the exact syntax problem.\n\nThe offending line appears to be:\n\n        output_6_2_5_list: \"{{ output_6_2_5.stdout_lines | list }}\"\n    - name: 6.2.5 Ensure users own their home directories | save output\n      ^ here\n"}[0m
[0;36m...ignoring[0m

TASK [cis_security : 6.2.5 Ensure users own their home directories | fix] *******************************************************************************************************************
[0;31mfatal: [dcpx-sqwea01]: FAILED! => {"msg": "'output_6_2_5_list' is undefined. 'output_6_2_5_list' is undefined"}[0m
[0;36m...ignoring[0m

TASK [cis_security : 6.2.6 Ensure users home directories permissions are 750 or more restrictive - list] ************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 6.2.6 Ensure users' home directories permissions are 750 or more restrictive - print output] ***************************************************************************
[0;31mfatal: [dcpx-sqwea01]: FAILED! => {"msg": "The task includes an option with an undefined variable. The error was: 'dict object' has no attribute 'stdout_lines'. 'dict object' has no attribute 'stdout_lines'\n\nThe error appears to be in '/home/gfk.com/ivan.stamov.adm/cis-hardening/roles/cis_security/tasks/type-files/ubuntu-20-type.yml': line 2956, column 7, but may\nbe elsewhere in the file depending on the exact syntax problem.\n\nThe offending line appears to be:\n\n      changed_when: false\n    - name: 6.2.6 Ensure users' home directories permissions are 750 or more restrictive - print output\n      ^ here\n"}[0m
[0;36m...ignoring[0m

TASK [cis_security : 6.2.6 Ensure users home directories permissions are 750 or more restrictive - fix] *************************************************************************************
[1;35m[WARNING]: conditional statements should not include jinja2 templating delimiters such as {{ }} or {% %}. Found: {{ output_6_2_6.stdout_lines|length > 0 }}[0m
[0;31mfatal: [dcpx-sqwea01]: FAILED! => {"msg": "'dict object' has no attribute 'stdout_lines'. 'dict object' has no attribute 'stdout_lines'"}[0m
[0;36m...ignoring[0m

TASK [cis_security : 6.2.7 Ensure users' dot files are not group or world writable | list] **************************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 6.2.7 Ensure users' dot files and folders are not group or world writable | list] **************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 6.2.7 Ensure users' dot files are not group or world writable | save output] *******************************************************************************************
[0;31mfatal: [dcpx-sqwea01]: FAILED! => {"msg": "The task includes an option with an undefined variable. The error was: 'dict object' has no attribute 'stdout'. 'dict object' has no attribute 'stdout'\n\nThe error appears to be in '/home/gfk.com/ivan.stamov.adm/cis-hardening/roles/cis_security/tasks/type-files/ubuntu-20-type.yml': line 2985, column 7, but may\nbe elsewhere in the file depending on the exact syntax problem.\n\nThe offending line appears to be:\n\n      when: fix_dot_include_folders\n    - name: 6.2.7 Ensure users' dot files are not group or world writable | save output\n      ^ here\n"}[0m
[0;36m...ignoring[0m

TASK [cis_security : 6.2.7 Ensure users' dot files and folders are not group or world writable | save output] *******************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 6.2.7 Ensure users' dot files are not group or world writable | correct file permissions] ******************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 6.2.7 Ensure users' dot files and folders are not group or world writable | correct file permissions] ******************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 6.2.8 Ensure no users have .netrc files | list] ************************************************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 6.2.8 Ensure no users have .netrc files | save output] *****************************************************************************************************************
[0;31mfatal: [dcpx-sqwea01]: FAILED! => {"msg": "The task includes an option with an undefined variable. The error was: 'dict object' has no attribute 'stdout'. 'dict object' has no attribute 'stdout'\n\nThe error appears to be in '/home/gfk.com/ivan.stamov.adm/cis-hardening/roles/cis_security/tasks/type-files/ubuntu-20-type.yml': line 3030, column 7, but may\nbe elsewhere in the file depending on the exact syntax problem.\n\nThe offending line appears to be:\n\n      changed_when: false\n    - name: 6.2.8 Ensure no users have .netrc files | save output\n      ^ here\n"}[0m
[0;36m...ignoring[0m

TASK [cis_security : 6.2.9 Ensure no users have .forward files | list] **********************************************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 6.2.9 Ensure no users have .forward files  | save output] **************************************************************************************************************
[0;31mfatal: [dcpx-sqwea01]: FAILED! => {"msg": "The task includes an option with an undefined variable. The error was: 'dict object' has no attribute 'stdout'. 'dict object' has no attribute 'stdout'\n\nThe error appears to be in '/home/gfk.com/ivan.stamov.adm/cis-hardening/roles/cis_security/tasks/type-files/ubuntu-20-type.yml': line 3049, column 7, but may\nbe elsewhere in the file depending on the exact syntax problem.\n\nThe offending line appears to be:\n\n      changed_when: false\n    - name: 6.2.9 Ensure no users have .forward files  | save output\n      ^ here\n"}[0m
[0;36m...ignoring[0m

TASK [cis_security : 6.2.10 Ensure no users have .rhosts files | list] **********************************************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 6.2.10 Ensure no users have .rhosts files | save output] ***************************************************************************************************************
[0;31mfatal: [dcpx-sqwea01]: FAILED! => {"msg": "The task includes an option with an undefined variable. The error was: 'dict object' has no attribute 'stdout'. 'dict object' has no attribute 'stdout'\n\nThe error appears to be in '/home/gfk.com/ivan.stamov.adm/cis-hardening/roles/cis_security/tasks/type-files/ubuntu-20-type.yml': line 3067, column 7, but may\nbe elsewhere in the file depending on the exact syntax problem.\n\nThe offending line appears to be:\n\n      changed_when: false\n    - name: 6.2.10 Ensure no users have .rhosts files | save output\n      ^ here\n"}[0m
[0;36m...ignoring[0m

TASK [cis_security : 6.2.11 Ensure root is the only UID 0 account| list] ********************************************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 6.2.11 Ensure root is the only UID 0 account | Save output] ************************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after: /root/.ansible/tmp/ansible-local-84243cyyxpcxo/tmp5kg_vjos[0m
[0;32m[0m[0;36m@@ -0,0 +1 @@[0m
[0;36m[0m[0;32m+[][0m
[0;32m\ No newline at end of file[0m
[0;32m[0m
[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 6.2.12 Ensure root PATH Integrity | run | Delete non-existing folders from PATH] ***************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 6.2.12 Ensure root PATH Integrity | run] *******************************************************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 6.2.12 Ensure root PATH Integrity | run] *******************************************************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 6.2.12 Ensure root PATH Integrity | save output] ***********************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 6.2.13 Ensure no duplicate UIDs exist | list] **************************************************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 6.2.13 Ensure no duplicate UIDs exist | save output] *******************************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after: /root/.ansible/tmp/ansible-local-84243cyyxpcxo/tmp6qr_iq2q[0m
[0;32m[0m[0;36m@@ -0,0 +1 @@[0m
[0;36m[0m[0;32m+{"changed": false, "stdout": "", "stderr": "", "rc": 0, "cmd": "cut -f3 -d\":\" /etc/passwd | sort -n | uniq -c | while read x; do\n    [ -z \"$x\" ] && break\n    set - $x\n    if [ $1 -gt 1 ]; then\n        users=$(awk -F: '($3 == n) { print $1 }' n=$2 /etc/passwd | xargs)\n        echo \"Duplicate UID ($2): $users\"\n    fi\ndone\n", "start": null, "end": null, "delta": null, "msg": "Command would have run if not in check mode", "skipped": true, "stdout_lines": [], "stderr_lines": [], "failed": false}[0m
[0;32m\ No newline at end of file[0m
[0;32m[0m
[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 6.2.14 Ensure no duplicate GIDs exist | list] **************************************************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 6.2.14 Ensure no duplicate GIDs exist | save output] *******************************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after: /root/.ansible/tmp/ansible-local-84243cyyxpcxo/tmpl43fvyvx[0m
[0;32m[0m[0;36m@@ -0,0 +1 @@[0m
[0;36m[0m[0;32m+{"changed": false, "stdout": "", "stderr": "", "rc": 0, "cmd": "cut -d: -f3 /etc/group | sort | uniq -d | while read x; do\n    echo \"Duplicate GID ($x) in /etc/group\"\ndone\n", "start": null, "end": null, "delta": null, "msg": "Command would have run if not in check mode", "skipped": true, "stdout_lines": [], "stderr_lines": [], "failed": false}[0m
[0;32m\ No newline at end of file[0m
[0;32m[0m
[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 6.2.15 Ensure no duplicate user names exist | list] ********************************************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 6.2.15 Ensure no duplicate user names exist | save output] *************************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after: /root/.ansible/tmp/ansible-local-84243cyyxpcxo/tmpxnx1r89v[0m
[0;32m[0m[0;36m@@ -0,0 +1 @@[0m
[0;36m[0m[0;32m+[][0m
[0;32m\ No newline at end of file[0m
[0;32m[0m
[0;33mchanged: [dcpx-sqwea01][0m

TASK [cis_security : 6.2.16 Ensure no duplicate group names exist | list] *******************************************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 6.2.16 Ensure no duplicate group names exist | save output] ************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : 6.2.17 Ensure shadow group is empty | list] ****************************************************************************************************************************
[0;36mskipping: [dcpx-sqwea01][0m

TASK [cis_security : 6.2.17 Ensure shadow group is empty | save output] *********************************************************************************************************************
[0;32mok: [dcpx-sqwea01][0m

TASK [cis_security : Add hardening file.] ***************************************************************************************************************************************************
[0;33mchanged: [dcpx-sqwea01][0m

PLAY RECAP **********************************************************************************************************************************************************************************
[0;33mdcpx-sqwea01[0m               : [0;32mok=169 [0m [0;33mchanged=67  [0m unreachable=0    failed=0    [0;36mskipped=75  [0m rescued=0    [1;35mignored=13  [0m


Script done on 2023-06-26 12:51:12+02:00
